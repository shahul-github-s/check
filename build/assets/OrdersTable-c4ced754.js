import{j as e,r as c}from"./mui-8e0c5bf3.js";import{k as u,S as g,u as P,b as x,B as y}from"./index-21565b90.js";import{n as A}from"./helpers-fc71785b.js";import{P as I}from"./Pagination-2529682b.js";import{S as k}from"./Search-4583bb5c.js";const E=({item:a,index:n,data:s})=>e.jsxs("div",{className:u("flex gap-4 px-4 md:h-full md:!p-0 md:justify-center",{"pt-4":n===0,"pb-4":n===s.length-1,"md:border-r":n!==s.length-1}),children:[e.jsx("i",{className:`icon-${a.icon}-regular text-turquoise text-[24px] mt-[15px]`}),e.jsxs("div",{className:"flex flex-col gap-[3px]",children:[e.jsx("span",{className:"counter",children:A(a.value)}),e.jsx("span",{className:"uppercase text-xs font-medium text-label",children:a.label})]})]}),h=({item:a,index:n,data:s})=>e.jsxs("div",{className:u("flex gap-4 px-4 md:h-full md:!p-0 md:justify-center",{"pt-4":n===0,"pb-4":n===s.length-1,"md:border-r":n!==s.length-1}),children:[e.jsx("i",{className:`icon-${a.icon}-regular text-turquoise text-[24px] mt-[15px]`}),e.jsxs("div",{className:"flex flex-col gap-[3px]",children:[e.jsx("span",{className:"counter",children:a.value}),e.jsx("span",{className:"uppercase text-xs font-medium text-label",children:a.label})]})]}),D=()=>{const[a,n]=c.useState([{icon:"square-list",value:0,label:"Lead Count"}]),[s,i]=c.useState([{icon:"square-fragile",value:0,label:"Unsettled Amount"},{icon:"box-check",value:0,label:"In Hand Cash"},{icon:"bars-progress",value:0,label:"UPI Transaction"}]);return c.useEffect(()=>{const o=setInterval(()=>{fetch("https://script.google.com/macros/s/AKfycbz6Ii_J9oaFD7F_nxFaDwxsSdls-7mQwM4ogEHfgSzJAMVffRBvorjwdtFTcOfjFWGErA/exec").then(l=>l.json()).then(l=>{n([{icon:"cart-circle-xmark",value:l.excess.leadCount,label:"Lead Count"}]),i([{icon:"square-fragile",value:l.data.unsettledAmount,label:"Unsettled Amount"},{icon:"box-check",value:l.data.inHandCash,label:"In Hand Cash"},{icon:"bars-progress",value:l.data.upiTransaction,label:"UPI Transaction"}])}).catch(l=>{console.error("Error fetching data:",l)})},100);return()=>clearInterval(o)},[]),e.jsxs(g,{className:"bg-turquoise md:h-[180px] rounded-[20px] p-5 xs:p-6",children:[e.jsx("p",{className:"text-white text-[15px] font-semibold uppercase mb-2.5",children:"Profit Tracker"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 bg-widget rounded-2xl md:grid-cols-4 md:h-[100px] md:py-4 md:items-center md:gap-0",children:[a.map((t,o)=>e.jsxs(c.Fragment,{children:[e.jsx(h,{index:o,data:a,item:t}),o!==a.length-1&&e.jsx("div",{className:"h-[1px] bg-border md:hidden"})]},t.label)),s.map((t,o)=>e.jsxs(c.Fragment,{children:[e.jsx(E,{index:o,data:s,item:t}),o!==s.length-1&&e.jsx("div",{className:"h-[1px] bg-border md:hidden"})]},t.label))]})]})},O=()=>{const[a,n]=c.useState([]);return c.useEffect(()=>{const i=setInterval(()=>{fetch("https://script.google.com/macros/s/AKfycbw2tc7af1ghd5RrVZAknKetGJgqZXItT5CnZZguIzKBSQgTSa-nUyra458Uvs2ksIwo0A/exec").then(t=>t.json()).then(t=>{n([{icon:"arrow-right-arrow-left",value:t.order1.value,label:t.order1.label},{icon:"arrow-right-arrow-left",value:t.order2.value,label:t.order2.label},{icon:"square-list",value:t.order3.value,label:t.order3.label},{icon:"square-list",value:t.order4.value,label:t.order4.label}])}).catch(t=>{console.error("Error fetching data:",t)})},100);return()=>clearInterval(i)},[]),e.jsxs(g,{className:"bg-blue md:h-[180px] rounded-[20px] p-5 xs:p-6",children:[e.jsx("p",{className:"text-white text-[15px] font-semibold uppercase mb-2.5",children:"Top Rank"}),e.jsx("div",{className:`grid grid-cols-1 gap-4 bg-widget rounded-2xl md:grid-cols-4 md:h-[100px] md:py-4
                 md:items-center md:gap-0`,children:a.length>0&&a.map((s,i)=>e.jsxs(c.Fragment,{children:[e.jsx(h,{item:s,index:i,data:a}),i!==a.length-1&&e.jsx("div",{className:"h-[1px] bg-border md:hidden"})]},s.label))})]})},q=()=>{P();const[a,n]=c.useState([]),[s,i]=c.useState({currentPage:0,itemsPerPage:10}),[t,o]=c.useState("");c.useEffect(()=>{x.get("https://script.google.com/macros/s/AKfycbwimtycCca8PsR_HJgYupB1CdPLbF5_s5LN7K6ZeSBQf6i0ADwKgxmhG9hjkNZAJcZ2Iw/exec").then(r=>{n(r.data)}).catch(r=>console.error("Error fetching data:",r))},[]);const{currentPage:l,itemsPerPage:m}=s,f=a.length,b=Math.ceil(f/m),v=["Ration Card","Voter Id","Aadhar Card","Pan Card","College Application","License and RTO Services","Money Transfer Services","Counselling Apply","TN Police","TNEB","Online Payments","Dharisanam Bookings","Typing Services","MSME","UDAY Scheme","Income Certificate","Community Certificate","Nativity Certificate","Intercaste Marriage Certificate","Obc Certificate","No Male Child Certificate","First Graduate Certificate","Small/Marginal Farmer Certificate","Widow Certificate","Deserted Women Certificate","Disability Pension Scheme","Widow Pension Scheme","Deserted Women Pension Scheme","Unmarried Women Pension Scheme","Old Age Pension Scheme","TN Employment Registration","Government Job Application","Passport","Flight Ticket","Visa","Certificate Attestation","Bus Booking","Visa Stamping","Cruise Booking","Hotel Booking","Medical Appointment","Tour Services","Outline"],p=a.filter(r=>{const d=r["Service Unit Report "];return d&&v.includes(d.trim())&&d.toLowerCase().includes(t.toLowerCase())}),j=p.slice(l*m,(l+1)*m),S=r=>{r>=0&&r<b&&i({...s,currentPage:r})},N=[{title:"Service Unit Report",dataIndex:"Service Unit Report ",key:"Service Unit Report ",fixed:"left",render:r=>r||null},...Object.keys(a[0]||{}).filter(r=>r!=="Service Unit Report ").map(r=>({title:r.trim(),dataIndex:r.trim(),key:r.trim()}))],C=async()=>{const r="https://script.google.com/macros/s/AKfycbxxXOD5B6DNDRQ1uaABOAqc_et_286dw__ZOxXpIfpquN2wbyhaARGmn5BpfYbEDUkx2g/exec";try{const d=await x.get(r),{url:w}=d.data;window.open(w,"_blank")}catch(d){console.error("Error exporting file:",d)}};return e.jsx("div",{className:"orders-table",children:e.jsxs("div",{className:"flex flex-col flex-1 gap-6 py-4 px-5 xs:px-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row",children:[e.jsx(k,{wrapperClass:"flex-1",value:t,onChange:o,placeholder:"Search for Service..."}),e.jsxs("button",{className:"btn btn--base h-[50px] px-5 gap-2",onClick:C,children:[e.jsx("i",{className:"icon-arrow-down-to-line-regular text-[16px]"}),"Export"]})]}),e.jsx(y,{columns:N,dataSource:j,rowKey:"Service Unit Report ",pagination:!1,scroll:{x:"max-content"}}),e.jsx(I,{currentPage:l,totalItems:p.length,itemsPerPage:m,onPageChange:S})]})})};export{O as F,D as O,q as a};
